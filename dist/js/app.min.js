angular.module("sampleApp",["ngAnimate","ui.bootstrap","ngRoute","ng-currency"]),angular.module("sampleApp").config(function($routeProvider,$locationProvider){$routeProvider.when("/customers",{controller:"transactionCtrl",templateUrl:"partials/transactions.html"}).when("/customers/:id/transactions",{controller:"transactionCtrl",templateUrl:"partials/transactions.html"}).when("/customers/:id/benefits",{controller:"benefitCtrl",templateUrl:"partials/benefits.html"}).when("/customers/:id/historical",{controller:"historicalCtrl",templateUrl:"partials/historical.html"}).otherwise({redirectTo:"/customers"})}),angular.module("sampleApp").service("apiService",["$http","$q",function(http,q){return{getCustomers:function(){var deferred=q.defer();return http.get("http://www.mocky.io/v2/598d010a260000b614ec23dc").then(function(data){deferred.resolve(data)},function(err){deferred.reject(err)}),deferred.promise},getCustomer:function(customerId){var deferred=q.defer();return http.get("http://www.mocky.io/v2/598e6cbb0f00000f0a1c8e40/"+customerId).then(function(data){deferred.resolve(data)},function(err){deferred.reject(err)}),deferred.promise},getCustomerPoints:function(customerId){var deferred=q.defer();return http.get("http://www.mocky.io/v2/598e36c90f0000140a1c8e1b/"+customerId).then(function(data){deferred.resolve(data)},function(err){deferred.reject(err)}),deferred.promise},getCustomerBenefits:function(customerId){var deferred=q.defer();return http.get("/user/address").then(function(data){deferred.resolve(data)},function(err){deferred.reject(err)}),deferred.promise},getCustomerHistorical:function(customerId){var deferred=q.defer();return http.get("/user/address").then(function(data){defer.resolve(data)},function(err){defer.reject(err)}),deferred.promise}}}]),angular.module("sampleApp").directive("format",["$filter",function($filter){return{require:"?ngModel",link:function(scope,elem,attrs,ctrl){ctrl&&(ctrl.$formatters.unshift(function(a){return $filter(attrs.format)(ctrl.$modelValue)}),ctrl.$parsers.unshift(function(viewValue){return elem.priceFormat({prefix:"",centsSeparator:",",thousandsSeparator:"."}),elem[0].value}))}}}]),angular.module("sampleApp").controller("historicalCtrl",["$scope",function($scope){}]),angular.module("sampleApp").controller("benefitCtrl",["$scope",function($scope){}]),angular.module("sampleApp").controller("transactionCtrl",["$scope","$routeParams","apiService",function($scope,$routeParams,apiService){$scope.paymentTypes=[{id:1,label:"A vista"},{id:2,label:"3 vezes"},{id:3,label:"4 vezes"},{id:4,label:"5 vezes"},{id:5,label:"6 vezes"}],$scope.invoices=[],$routeParams.id?(apiService.getCustomer($routeParams.id).then(function(response){$scope.setCustomer(response.data),$scope.customer=response.data},function(err){$scope.setCustomer({codigo:0})}),apiService.getCustomerPoints().then(function(response){$scope.points=response.data,$scope.points.total&&($scope.points.saldo=$scope.points.total-($scope.points.utilizados-$scope.points.expirados))},function(err){$scope.points={total:0,utilizados:0,expirados:0}})):$scope.setCustomer({codigo:0}),$scope.addInvoice=function(invoice){$scope.invoiceForm.$valid&&(invoice.createDate=new Date,$scope.invoices.push(invoice),$scope.resetInvoice())},$scope.resetInvoice=function(){$scope.invoice={},$scope.invoiceForm.$setPristine(),$("#store").focus()},$scope.saveInvoices=function(invoices){$scope.invoices=[],$scope.resetInvoice()}}]),angular.module("sampleApp").controller("customerCtrl",["$scope","$location","apiService",function($scope,$location,apiService){$scope.setCustomer=function(customer){$scope.disabled=0==customer.codigo,$scope.customer=customer},$scope.selectCustomer=function(id){$scope.getTransactions(id)},$scope.getTransactions=function(id){$location.path("/customers/"+id+"/transactions")},$scope.getBenefits=function(id){$location.path("/customers/"+id+"/benefits")},$scope.getHistorical=function(id){$location.path("/customers/"+id+"/historical")},$scope.getCustomers=function(){$location.path("/customers")},apiService.getCustomers().then(function(response){$scope.customers=response.data},function(err){$scope.customers=[]}),$scope.setCustomer({codigo:0})}]);